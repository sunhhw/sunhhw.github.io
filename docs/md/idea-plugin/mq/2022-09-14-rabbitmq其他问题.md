## 一、消息堆积怎么处理

消息堆积的原因：

- 消费者消费能力低，生产者生产消息速度过快，导致mq中的消息堆积
- 消费者宕机了

解决方案：

- 扩大队列的最大长度限制
- 增加消费者的消费能力，比如可以开启多线程处理
- 增加消费者，多加几个消费者服务一起消费

## 二、消息防止重复消费

在生产者发送消息时候传递一个唯一的标志，比如订单号等，消费成功后存入redis，每次消费的一开始就去查询该唯一标识是否存在，如果存在则说明已经消费过了，反之则没有被消费过，如果一批消息中不存在唯一标志，那只能根据业务参数组建唯一标志存入redis。